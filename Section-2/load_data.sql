-- LOAD MEMBERS
CREATE TABLE memberstemp (
    name VARCHAR,
    email VARCHAR,
    date_of_birth VARCHAR(8),
    mobile_no VARCHAR(8),
    above_18 VARCHAR,
    first_name VARCHAR,
    last_name VARCHAR,
    membership_id VARCHAR
);

\copy memberstemp FROM '/docker-entrypoint-initdb.d/20230520-1349-applications_dataset.csv' DELIMITER ',' CSV HEADER

INSERT INTO members (membership_id, first_name, last_name, email, mobile_no, date_of_birth)
SELECT
    membership_id,
    first_name,
    last_name,
    email,
    mobile_no,
    date_of_birth
FROM memberstemp
ON CONFLICT (membership_id)
DO NOTHING;

DROP TABLE memberstemp;

-- LOAD ITEMS
INSERT INTO items (item_name, manufacturer_name, cost, weight)
VALUES
    ('item 1 from m1', 'manufacturer 1', 10.40, 0.23),
    ('item 2 from m1', 'manufacturer 1', 729.20, 18.12),
    ('item 3 from m1', 'manufacturer 1', 123.90, 237.24),
    ('item 1 from m2', 'manufacturer 2', 23.30, 0.34),
    ('item 2 from m2', 'manufacturer 2', 23.30, 0.34),
    ('item 1 from m3', 'manufacturer 3', 2.00, 0.62),
    ('item 2 from m3', 'manufacturer 3', 2.00, 1.29),
    ('item 3 from m3', 'manufacturer 3', 2.00, 0.37);

-- LOAD TRANSACTOPNS
INSERT INTO transactions (transaction_id, total_price, total_weight, membership_id)
VALUES
    (1, 115.6, 8.39, 'Randolph_76c7a'),
    (2, 7107.4, 2520.41, 'Martin_6f48d'),
    (3, 508.2, 722.63, 'Sanford_c7e24'),
    (4, 920.5, 1428.41, 'Wilkins_48a0a'),
    (5, 925.9, 256.97, 'Estrada_0bf5b'),
    (6, 867.3, 1660.68, 'Martin_35f44'),
    (7, 322.9, 16.89, 'Cline_825fb'),
    (8, 14.0, 4.09, 'Willis_d0046'),
    (9, 1507.7, 43.14, 'Williams_3e726'),
    (10, 247.8, 474.48, 'Lee_76cce'),
    (11, 604.7, 715.12, 'Pittman_44c4d'),
    (12, 7486.4, 186.4, 'Anthony_ebd30'),
    (13, 359.5, 11.55, 'Williams_3e726'),
    (14, 6656.7, 174.06, 'Murphy_0851c'),
    (15, 317.7, 475.5, 'Pittman_44c4d'),
    (16, 799.1, 19.14, 'Martin_6f48d'),
    (17, 453.4, 19.77, 'Murphy_0851c'),
    (18, 243.0, 9.18, 'Smith_c7677'),
    (19, 298.4, 243.96, 'Johnson_d53b7'),
    (20, 2524.3, 65.06, 'Allison_0c21b'),
    (21, 139.8, 2.04, 'Cantrell_b19eb'),
    (22, 1522.4, 45.13, 'Taylor_4fbc5'),
    (23, 404.1, 7.26, 'Rhodes_df266'),
    (24, 6772.6, 407.98, 'Cantrell_b19eb'),
    (25, 98.6, 1.83, 'Pittman_44c4d'),
    (26, 434.9, 720.33, 'Flores_8a42c'),
    (27, 6113.2, 149.04, 'Thompson_16040'),
    (28, 5153.2, 136.16, 'Thompson_16040'),
    (29, 3110.4, 1245.69, 'Williams_3e726'),
    (30, 1634.3, 274.63, 'Lynch_49515'),
    (31, 715.0, 961.45, 'King_01148'),
    (32, 1962.9, 2168.01, 'Sanchez_364a7'),
    (33, 197.0, 13.22, 'Johnson_d53b7'),
    (34, 495.6, 948.96, 'Wilkins_48a0a'),
    (35, 1147.3, 1665.47, 'Bright_776f9'),
    (36, 1432.6, 1210.69, 'Willis_d0046'),
    (37, 577.0, 719.74, 'Gomez_876bf'),
    (38, 3870.4, 108.96, 'Rhodes_df266'),
    (39, 46.6, 0.68, 'Rhodes_df266'),
    (40, 116.0, 10.04, 'Bright_776f9'),
    (41, 7251.7, 2530.06, 'Smith_634dd'),
    (42, 149.8, 5.14, 'Garza_40199'),
    (43, 395.7, 719.42, 'Guerrero_d55cb'),
    (44, 7545.9, 188.52, 'Thompson_52cd0'),
    (45, 173.1, 5.48, 'Lynch_49515'),
    (46, 1028.9, 1192.8, 'Wang_04168'),
    (47, 49.2, 6.36, 'Turner_0303a'),
    (48, 16.0, 4.96, 'Pittman_44c4d'),
    (49, 20.0, 3.7, 'Pittman_44c4d'),
    (50, 105.2, 4.83, 'Smith_634dd'),
    (51, 2187.6, 54.36, 'Nichols_9226a'),
    (52, 8873.6, 2562.03, 'Lee_76cce'),
    (53, 326.2, 4.76, 'Smith_634dd'),
    (54, 267.8, 479.43, 'Richardson_ef158'),
    (55, 1115.1, 2135.16, 'Meyers_2871d'),
    (56, 3674.3, 1278.22, 'Thompson_52cd0'),
    (57, 69.9, 1.02, 'Ramirez_5ff32'),
    (58, 3058.9, 1483.84, 'Johnson_d53b7'),
    (59, 371.7, 711.72, 'Wang_04168'),
    (60, 6.0, 1.11, 'King_01148'),
    (61, 520.0, 243.02, 'Taylor_4fbc5'),
    (62, 1284.4, 2153.27, 'Smith_634dd'),
    (63, 227.7, 14.67, 'Nichols_9226a'),
    (64, 1458.4, 36.24, 'Wilkins_48a0a'),
    (65, 4575.6, 120.47, 'Armstrong_e2fb8'),
    (66, 122.5, 5.57, 'Thompson_52cd0'),
    (67, 871.9, 1428.86, 'Sanford_c7e24'),
    (68, 1396.3, 2380.1, 'Murphy_0851c'),
    (69, 1046.8, 1903.27, 'Ramirez_5ff32'),
    (70, 6961.3, 879.13, 'Armstrong_e2fb8'),
    (71, 4395.2, 114.92, 'Wang_04168'),
    (72, 2854.8, 534.96, 'Martin_35f44'),
    (73, 312.4, 479.99, 'Gomez_876bf'),
    (74, 49.6, 6.08, 'Brady_bd431'),
    (75, 6229.7, 150.74, 'Cline_825fb'),
    (76, 5833.6, 144.96, 'Williams_3e726'),
    (77, 480.8, 477.88, 'Garcia_26b55'),
    (78, 6.0, 3.87, 'Meyers_2871d'),
    (79, 239.1, 11.98, 'Murphy_0851c'),
    (80, 46.6, 0.68, 'Brady_bd431'),
    (81, 6088.4, 151.59, 'Gonzalez_31e9a'),
    (82, 1453.3, 2142.14, 'Nichols_9226a'),
    (83, 5430.9, 1772.74, 'Smith_634dd'),
    (84, 925.9, 1669.1, 'Smith_634dd'),
    (85, 1759.4, 45.5, 'Ramirez_5ff32'),
    (86, 14.0, 9.03, 'Garcia_26b55'),
    (87, 32.0, 7.42, 'Pittman_44c4d'),
    (88, 597.4, 957.02, 'Guerrero_d55cb'),
    (89, 76.4, 8.57, 'Williams_e69d3'),
    (90, 5971.7, 1787.52, 'Nichols_9226a'),
    (91, 179.1, 12.7, 'Ramirez_5ff32'),
    (92, 2613.3, 767.6, 'Hall_b302a'),
    (93, 6576.8, 169.35, 'Garza_40199'),
    (94, 138.3, 3.51, 'Allison_0c21b'),
    (95, 4584.9, 111.78, 'Gomez_876bf'),
    (96, 2537.8, 64.06, 'Flores_8a42c'),
    (97, 20.0, 6.2, 'Ramirez_5ff32'),
    (98, 359.0, 17.13, 'Martin_6f48d'),
    (99, 1372.0, 2149.23, 'Galloway_1a4d2'),
    (100, 4400.8, 2452.0, 'Randolph_76c7a');

-- LOAD ORDERS
INSERT INTO orders (transaction_id, item_name, quantity)
VALUES
    (1, 'item 3 from m3', 2),
    (1, 'item 1 from m1', 9),
    (1, 'item 1 from m3', 9),
    (2, 'item 3 from m3', 7),
    (2, 'item 2 from m1', 8),
    (2, 'item 3 from m1', 10),
    (2, 'item 1 from m1', 2),
    (3, 'item 3 from m3', 4),
    (3, 'item 3 from m1', 3),
    (3, 'item 1 from m2', 5),
    (3, 'item 2 from m3', 6),
    (4, 'item 3 from m1', 6),
    (4, 'item 2 from m2', 7),
    (4, 'item 3 from m3', 7),
    (5, 'item 2 from m1', 1),
    (5, 'item 1 from m1', 7),
    (5, 'item 3 from m1', 1),
    (6, 'item 3 from m1', 7),
    (7, 'item 1 from m2', 2),
    (7, 'item 2 from m2', 7),
    (7, 'item 1 from m1', 8),
    (7, 'item 2 from m3', 7),
    (7, 'item 3 from m3', 8),
    (8, 'item 3 from m3', 1),
    (8, 'item 1 from m3', 6),
    (9, 'item 3 from m3', 6),
    (9, 'item 1 from m2', 1),
    (9, 'item 2 from m1', 2),
    (9, 'item 1 from m3', 7),
    (10, 'item 3 from m1', 2),
    (11, 'item 2 from m2', 10),
    (11, 'item 3 from m1', 3),
    (12, 'item 1 from m3', 4),
    (12, 'item 2 from m1', 10),
    (12, 'item 2 from m2', 8),
    (13, 'item 1 from m2', 7),
    (13, 'item 2 from m2', 8),
    (13, 'item 2 from m3', 5),
    (14, 'item 3 from m3', 6),
    (14, 'item 2 from m2', 3),
    (14, 'item 2 from m1', 9),
    (14, 'item 2 from m3', 6),
    (15, 'item 2 from m2', 3),
    (15, 'item 3 from m1', 2),
    (16, 'item 2 from m2', 3),
    (16, 'item 2 from m1', 1),
    (17, 'item 3 from m3', 9),
    (17, 'item 2 from m3', 8),
    (17, 'item 1 from m2', 9),
    (17, 'item 2 from m2', 9),
    (18, 'item 2 from m2', 10),
    (18, 'item 2 from m3', 4),
    (18, 'item 1 from m3', 1),
    (19, 'item 2 from m3', 3),
    (19, 'item 1 from m1', 5),
    (19, 'item 3 from m1', 1),
    (19, 'item 2 from m2', 5),
    (20, 'item 1 from m1', 6),
    (20, 'item 1 from m2', 1),
    (20, 'item 2 from m2', 10),
    (20, 'item 1 from m3', 9),
    (20, 'item 2 from m1', 3),
    (21, 'item 2 from m2', 6),
    (22, 'item 1 from m1', 5),
    (22, 'item 2 from m1', 2),
    (22, 'item 2 from m3', 6),
    (23, 'item 1 from m2', 9),
    (23, 'item 2 from m2', 8),
    (23, 'item 3 from m3', 4),
    (24, 'item 3 from m1', 1),
    (24, 'item 2 from m2', 3),
    (24, 'item 2 from m3', 4),
    (24, 'item 3 from m3', 4),
    (24, 'item 2 from m1', 9),
    (25, 'item 2 from m2', 2),
    (25, 'item 1 from m1', 5),
    (26, 'item 3 from m1', 3),
    (26, 'item 1 from m3', 8),
    (26, 'item 3 from m3', 8),
    (26, 'item 1 from m1', 3),
    (27, 'item 2 from m2', 9),
    (27, 'item 2 from m1', 8),
    (27, 'item 1 from m2', 3),
    (28, 'item 3 from m3', 10),
    (28, 'item 1 from m1', 2),
    (28, 'item 2 from m3', 4),
    (28, 'item 2 from m1', 7),
    (29, 'item 1 from m1', 9),
    (29, 'item 3 from m1', 5),
    (29, 'item 2 from m1', 3),
    (29, 'item 1 from m2', 9),
    (30, 'item 3 from m1', 1),
    (30, 'item 1 from m1', 5),
    (30, 'item 2 from m1', 2),
    (31, 'item 3 from m3', 9),
    (31, 'item 2 from m2', 6),
    (31, 'item 3 from m1', 4),
    (31, 'item 1 from m3', 10),
    (31, 'item 1 from m1', 4),
    (32, 'item 3 from m1', 9),
    (32, 'item 2 from m3', 10),
    (32, 'item 1 from m1', 5),
    (32, 'item 2 from m1', 1),
    (32, 'item 1 from m2', 2),
    (33, 'item 3 from m3', 1),
    (33, 'item 2 from m3', 4),
    (33, 'item 1 from m1', 3),
    (33, 'item 1 from m3', 8),
    (33, 'item 2 from m2', 6),
    (34, 'item 3 from m1', 4),
    (35, 'item 1 from m2', 8),
    (35, 'item 3 from m1', 7),
    (35, 'item 1 from m1', 9),
    (36, 'item 2 from m1', 1),
    (36, 'item 3 from m3', 4),
    (36, 'item 2 from m3', 3),
    (36, 'item 2 from m2', 3),
    (36, 'item 3 from m1', 5),
    (37, 'item 1 from m2', 5),
    (37, 'item 3 from m3', 1),
    (37, 'item 1 from m3', 7),
    (37, 'item 1 from m1', 7),
    (37, 'item 3 from m1', 3),
    (38, 'item 1 from m3', 5),
    (38, 'item 2 from m1', 5),
    (38, 'item 2 from m3', 8),
    (38, 'item 2 from m2', 8),
    (38, 'item 3 from m3', 6),
    (39, 'item 2 from m2', 2),
    (40, 'item 1 from m1', 10),
    (40, 'item 2 from m3', 6),
    (41, 'item 3 from m1', 10),
    (41, 'item 2 from m3', 8),
    (41, 'item 2 from m1', 8),
    (41, 'item 2 from m2', 4),
    (41, 'item 1 from m2', 3),
    (42, 'item 1 from m3', 5),
    (42, 'item 2 from m2', 6),
    (43, 'item 3 from m3', 7),
    (43, 'item 2 from m3', 3),
    (43, 'item 1 from m3', 2),
    (43, 'item 3 from m1', 3),
    (44, 'item 1 from m2', 2),
    (44, 'item 3 from m3', 9),
    (44, 'item 2 from m1', 10),
    (44, 'item 2 from m2', 5),
    (44, 'item 1 from m1', 7),
    (45, 'item 2 from m2', 7),
    (45, 'item 1 from m3', 5),
    (46, 'item 3 from m1', 5),
    (46, 'item 1 from m2', 6),
    (46, 'item 1 from m1', 8),
    (46, 'item 2 from m2', 8),
    (47, 'item 3 from m3', 5),
    (47, 'item 1 from m3', 2),
    (47, 'item 2 from m3', 2),
    (47, 'item 1 from m1', 3),
    (48, 'item 1 from m3', 8),
    (49, 'item 3 from m3', 10),
    (50, 'item 2 from m2', 4),
    (50, 'item 1 from m3', 5),
    (50, 'item 3 from m3', 1),
    (51, 'item 2 from m1', 3),
    (52, 'item 3 from m3', 8),
    (52, 'item 3 from m1', 10),
    (52, 'item 2 from m1', 10),
    (52, 'item 2 from m2', 10),
    (52, 'item 1 from m1', 9),
    (53, 'item 2 from m2', 8),
    (53, 'item 1 from m2', 6),
    (54, 'item 3 from m1', 2),
    (54, 'item 1 from m3', 5),
    (54, 'item 3 from m3', 5),
    (55, 'item 3 from m1', 9),
    (56, 'item 1 from m1', 10),
    (56, 'item 2 from m3', 10),
    (56, 'item 3 from m1', 5),
    (56, 'item 2 from m1', 4),
    (56, 'item 1 from m3', 7),
    (57, 'item 1 from m2', 3),
    (58, 'item 1 from m1', 5),
    (58, 'item 2 from m2', 3),
    (58, 'item 3 from m1', 6),
    (58, 'item 2 from m1', 3),
    (58, 'item 2 from m3', 3),
    (59, 'item 3 from m1', 3),
    (60, 'item 3 from m3', 3),
    (61, 'item 3 from m1', 1),
    (61, 'item 2 from m2', 9),
    (61, 'item 1 from m2', 8),
    (62, 'item 2 from m3', 9),
    (62, 'item 1 from m1', 2),
    (62, 'item 3 from m1', 9),
    (62, 'item 1 from m3', 7),
    (62, 'item 2 from m2', 5),
    (63, 'item 2 from m3', 9),
    (63, 'item 1 from m2', 9),
    (64, 'item 2 from m1', 2),
    (65, 'item 2 from m1', 6),
    (65, 'item 1 from m2', 8),
    (65, 'item 2 from m3', 7),
    (66, 'item 2 from m2', 5),
    (66, 'item 2 from m3', 3),
    (67, 'item 1 from m2', 5),
    (67, 'item 1 from m3', 6),
    (67, 'item 3 from m1', 6),
    (68, 'item 3 from m3', 8),
    (68, 'item 2 from m2', 5),
    (68, 'item 1 from m1', 2),
    (68, 'item 2 from m3', 2),
    (68, 'item 3 from m1', 10),
    (69, 'item 1 from m1', 4),
    (69, 'item 2 from m3', 2),
    (69, 'item 3 from m3', 5),
    (69, 'item 3 from m1', 8),
    (70, 'item 3 from m1', 3),
    (70, 'item 1 from m1', 2),
    (70, 'item 2 from m3', 3),
    (70, 'item 2 from m1', 9),
    (71, 'item 2 from m1', 6),
    (71, 'item 1 from m3', 10),
    (72, 'item 2 from m1', 3),
    (72, 'item 3 from m1', 2),
    (72, 'item 2 from m2', 8),
    (72, 'item 1 from m2', 10),
    (73, 'item 1 from m3', 6),
    (73, 'item 1 from m2', 2),
    (73, 'item 3 from m1', 2),
    (73, 'item 3 from m3', 3),
    (74, 'item 2 from m3', 4),
    (74, 'item 1 from m1', 4),
    (75, 'item 2 from m1', 8),
    (75, 'item 2 from m2', 7),
    (75, 'item 1 from m2', 10),
    (76, 'item 2 from m1', 8),
    (77, 'item 3 from m1', 2),
    (77, 'item 2 from m2', 10),
    (78, 'item 2 from m3', 3),
    (79, 'item 1 from m1', 5),
    (79, 'item 2 from m3', 3),
    (79, 'item 2 from m2', 7),
    (79, 'item 3 from m3', 4),
    (79, 'item 1 from m3', 5),
    (80, 'item 2 from m2', 2),
    (81, 'item 2 from m3', 1),
    (81, 'item 2 from m1', 8),
    (81, 'item 2 from m2', 8),
    (81, 'item 1 from m1', 6),
    (81, 'item 1 from m3', 2),
    (82, 'item 3 from m1', 9),
    (82, 'item 2 from m2', 6),
    (82, 'item 3 from m3', 6),
    (82, 'item 1 from m2', 8),
    (83, 'item 3 from m1', 7),
    (83, 'item 1 from m3', 1),
    (83, 'item 2 from m1', 6),
    (83, 'item 2 from m2', 8),
    (84, 'item 3 from m1', 7),
    (84, 'item 2 from m3', 6),
    (84, 'item 2 from m2', 2),
    (85, 'item 1 from m1', 5),
    (85, 'item 1 from m3', 7),
    (85, 'item 2 from m2', 10),
    (85, 'item 3 from m3', 1),
    (85, 'item 2 from m1', 2),
    (86, 'item 2 from m3', 7),
    (87, 'item 3 from m3', 10),
    (87, 'item 1 from m3', 6),
    (88, 'item 1 from m1', 3),
    (88, 'item 3 from m1', 4),
    (88, 'item 2 from m2', 2),
    (88, 'item 3 from m3', 3),
    (88, 'item 1 from m3', 9),
    (89, 'item 1 from m1', 6),
    (89, 'item 3 from m3', 2),
    (89, 'item 2 from m3', 5),
    (90, 'item 3 from m1', 7),
    (90, 'item 2 from m1', 7),
    (91, 'item 1 from m2', 7),
    (91, 'item 2 from m3', 8),
    (92, 'item 2 from m1', 3),
    (92, 'item 3 from m1', 3),
    (92, 'item 3 from m3', 1),
    (92, 'item 1 from m1', 5),
    (93, 'item 2 from m1', 9),
    (93, 'item 2 from m3', 4),
    (93, 'item 3 from m3', 3),
    (94, 'item 1 from m2', 2),
    (94, 'item 1 from m1', 6),
    (94, 'item 2 from m2', 1),
    (94, 'item 3 from m3', 3),
    (95, 'item 2 from m1', 6),
    (95, 'item 2 from m2', 9),
    (96, 'item 1 from m3', 2),
    (96, 'item 3 from m3', 10),
    (96, 'item 2 from m2', 4),
    (96, 'item 1 from m2', 10),
    (96, 'item 2 from m1', 3),
    (97, 'item 1 from m3', 10),
    (98, 'item 3 from m3', 3),
    (98, 'item 1 from m2', 10),
    (98, 'item 2 from m3', 8),
    (98, 'item 1 from m1', 10),
    (99, 'item 2 from m2', 9),
    (99, 'item 1 from m1', 3),
    (99, 'item 2 from m3', 8),
    (99, 'item 3 from m1', 9),
    (100, 'item 2 from m1', 4),
    (100, 'item 1 from m3', 6),
    (100, 'item 3 from m1', 10),
    (100, 'item 1 from m2', 2),
    (100, 'item 2 from m2', 8);



-- CREATE TRANSACTIONS
-- DROP TABLE IF EXISTS transactions;
-- CREATE TABLE transactions AS 
--     SELECT
--         orders.transaction_id,
--         orders.membership_id,
--         SUM(items.cost * orders.quantity), AS total_price,
--         SUM(items.weight * orders.quantity), AS total_weight
--     FROM orders
--     LEFT JOIN items ON (orders.item == item.item_name),
--     GROUP BY orders.transaction_id, orders.membership_id